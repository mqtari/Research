<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¨Ø§Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹</title>
    <style>
        body { font-family: system-ui, sans-serif; background: #f4f4f9; margin: 0; padding: 15px; color: #333; }
        .box { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 8px; box-sizing: border-box; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: #007bff; }
        button { width: 100%; background: #007bff; color: #fff; border: none; padding: 12px; border-radius: 8px; margin-top: 10px; cursor: pointer; font-size: 16px; font-weight: bold; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .item { background: #fff; padding: 15px; border-radius: 10px; margin-top: 15px; border-right: 5px solid #007bff; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        h3 { font-size: 16px; margin: 0 0 10px; color: #000; line-height: 1.4; }
        p { font-size: 13px; color: #555; line-height: 1.6; margin: 5px 0; }
        .dl { display: inline-block; background: #28a745; color: #fff; text-decoration: none; padding: 8px 15px; border-radius: 6px; font-size: 13px; margin-top: 10px; }
        #status { text-align: center; font-size: 14px; margin-top: 10px; color: #d9534f; font-weight: bold; }
    </style>
</head>
<body>

<div class="box">
    <h2 style="text-align:center; font-size: 20px; margin-bottom: 15px;">ğŸ” Ø§Ù„Ø¨Ø§Ø­Ø« Ø§Ù„Ø¹Ù„Ù…ÙŠ (PDF)</h2>
    <input type="text" id="query" placeholder="Ø§ÙƒØªØ¨ Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø« Ù‡Ù†Ø§...">
    <button id="btn" onclick="startSearch()">Ø§Ø¨Ø­Ø« Ø§Ù„Ø¢Ù†</button>
    <div id="status"></div>
</div>

<div id="results" style="max-width: 600px; margin: auto;"></div>

<script>
    // Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„ØªØ¬Ù†Ø¨ "Ø®Ø·Ø£ Ø§Ù„Ø´Ø¨ÙƒØ©"
    const proxies = [
        "https://api.allorigins.win/raw?url=",
        "https://api.codetabs.com/v1/proxy?quest="
    ];

    async function fetchData(url) {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ Ø§Ù„Ø£ÙˆÙ„ØŒ ÙˆØ¥Ø°Ø§ ÙØ´Ù„ Ù†Ø¬Ø±Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ
        for (let proxy of proxies) {
            try {
                const response = await fetch(proxy + encodeURIComponent(url));
                if (response.ok) return await response.json();
            } catch (e) { console.log("Proxy failed, trying next..."); }
        }
        throw new Error("Network Error");
    }

    async function translate(text, target) {
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${target}&dt=t&q=${encodeURIComponent(text)}`;
        try {
            for (let proxy of proxies) {
                try {
                    const response = await fetch(proxy + encodeURIComponent(url));
                    const data = await response.json();
                    return data[0].map(x => x[0]).join('');
                } catch (e) { continue; }
            }
            return text;
        } catch { return text; }
    }

    async function startSearch() {
        const query = document.getElementById('query').value;
        const btn = document.getElementById('btn');
        const status = document.getElementById('status');
        const resultsDiv = document.getElementById('results');

        if (!query) return;

        btn.disabled = true;
        status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø©...";
        status.style.color = "#666";
        resultsDiv.innerHTML = '';

        try {
            // 1. ØªØ±Ø¬Ù…Ø© Ù„Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ù…Ø«Ù„ Ø§Ù„Ø¨Ø§ÙŠØ«ÙˆÙ†
            const qEn = await translate(query, 'en');

            // 2. Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¹Ù„Ù…ÙŠ
            const searchUrl = `https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURIComponent(qEn)}&limit=15&fields=title,abstract,openAccessPdf`;
            const data = await fetchData(searchUrl);

            if (!data.data || data.data.length === 0) {
                status.innerText = "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø¨Ø­Ø§Ø« Ù…Ø¬Ø§Ù†ÙŠØ©.";
            } else {
                status.innerText = "";
                for (let paper of data.data) {
                    if (paper.openAccessPdf && paper.openAccessPdf.url) {
                        // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø®Ù„Ø§ØµØ© Ù„Ù„Ø¹Ø±Ø¨ÙŠ (Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø§ÙŠØ«ÙˆÙ†)
                        const titleAr = await translate(paper.title, 'ar');
                        const abstract = paper.abstract ? (paper.abstract.substring(0, 200) + "...") : "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø®Øµ.";
                        const abstractAr = await translate(abstract, 'ar');

                        const card = document.createElement('div');
                        card.className = 'item';
                        card.innerHTML = `
                            <h3>${titleAr}</h3>
                            <p><strong>ğŸ‡¬ğŸ‡§ Ø§Ù„Ø®Ù„Ø§ØµØ©:</strong> ${abstract}</p>
                            <p><strong>ğŸ‡¸ğŸ‡¦ Ø§Ù„ØªØ±Ø¬Ù…Ø©:</strong> ${abstractAr}</p>
                            <a href="${paper.openAccessPdf.url}" target="_blank" class="dl">ğŸ“¥ ØªÙ†Ø²ÙŠÙ„ PDF</a>
                        `;
                        resultsDiv.appendChild(card);
                    }
                }
                if (resultsDiv.innerHTML === "") status.innerText = "âŒ Ù„Ù… Ù†Ø¬Ø¯ Ø±ÙˆØ§Ø¨Ø· PDF Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬.";
            }
        } catch (error) {
            status.innerText = "âŒ Ø®Ø·Ø£: Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…Ø´ØºÙˆÙ„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¨Ø¹Ø¯ Ù„Ø­Ø¸Ø§Øª.";
            status.style.color = "red";
        } finally {
            btn.disabled = false;
        }
    }
</script>

</body>
</html>